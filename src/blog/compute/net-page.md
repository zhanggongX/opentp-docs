---
title: 打开一个网页发生了啥
category:
  - 计算机基础
order: 22
tag:
  - 计算机基础
  - 网络
---

DNS解析、TCP/IP连接、HTTP请求、数据传输和渲染等。

### 输入URL并按下回车

当你在浏览器地址栏中输入一个URL（例如`https://www.baidu.com`）并按下回车键时，浏览器首先会解析这个URL。

### DNS解析

URL包含域名（例如`www.baidu.com`），浏览器需要将这个域名转换为IP地址才能与服务器通信。
- DNS查询：浏览器首先会检查本地缓存（如本地DNS缓存和操作系统缓存）中是否有该域名的IP地址。如果没有找到，它会发起一个DNS查询请求。
- 递归查询：DNS查询请求首先发送到本地DNS服务器（通常是ISP提供的），如果本地DNS服务器没有该域名的记录，它会进行递归查询，从根DNS服务器开始，逐级向下查询，直到找到域名对应的IP地址。
- 获取IP地址：最终，浏览器获得了域名对应的IP地址（例如`xx.xx.xx.xx`）。

### TCP/IP连接
获得IP地址后，浏览器需要与目标服务器建立连接。
- 三次握手：浏览器使用TCP协议与服务器建立连接，具体步骤如下：
  1. SYN：浏览器发送一个SYN（同步）包到服务器，表示请求建立连接。
  2. SYN-ACK：服务器收到请求后，返回一个SYN-ACK包，表示同意建立连接。
  3. ACK：浏览器接收到SYN-ACK包后，发送一个ACK（确认）包，表示连接建立成功。

### 发送HTTP请求

连接建立后，浏览器会发送一个HTTP请求到服务器。
- 请求方法：常见的请求方法有`GET`（请求资源）、`POST`（提交数据）、`PUT`（更新资源）等。浏览器通常会发送一个`GET`请求来获取网页内容。
- 请求头：请求头中包含一些元数据，例如浏览器类型、语言偏好、Cookie等信息。
- 请求体：在`POST`等请求方法中，请求体中可以包含要提交的数据。

### 服务器处理请求
服务器接收到请求后，会处理这个请求并生成响应。
- 处理请求：服务器根据URL路径和请求方法，调用相应的应用程序或脚本来生成响应。例如，服务器可能会从数据库中读取数据，或者从文件系统中读取网页文件。
- 生成响应：服务器会生成一个HTTP响应，通常包括状态码、响应头和响应体。

### 数据传输
服务器将响应数据通过TCP连接传回给浏览器。
- 分段传输：如果响应数据较大，服务器可能会将数据分成多个TCP包进行传输。浏览器会接收到这些包，并按照顺序组装成完整的数据。
- 数据加密：如果使用HTTPS协议，传输的数据会通过TLS（传输层安全性协议）进行加密，确保数据在传输过程中不被窃取或篡改。

### 浏览器接收响应
浏览器接收到服务器的响应后，会进行处理。
- 解析响应：浏览器首先检查HTTP状态码，确定请求是否成功（例如，状态码`200 OK`表示成功）。然后，浏览器会解析响应头，了解数据的格式、编码等信息。
- 渲染内容：浏览器会根据响应体中的HTML内容开始渲染网页。

### 渲染网页

浏览器解析HTML、CSS和JavaScript，将网页渲染到屏幕上。
- HTML解析：浏览器解析HTML文档，生成DOM（文档对象模型）树，表示网页的结构。
- CSS解析：浏览器解析CSS文件，生成CSSOM（CSS对象模型）树，表示样式规则。
- 生成渲染树：浏览器将DOM树和CSSOM树合并，生成渲染树，表示网页的可视内容。
- 布局和绘制：浏览器根据渲染树计算每个元素的布局（位置和大小），然后将其绘制到屏幕上。
- 执行JavaScript：浏览器执行网页中的JavaScript代码，可能会动态更新DOM和CSSOM，重新布局和绘制网页。

### 关闭连接
- 四次挥手：浏览器和服务器完成数据传输后，会进行TCP连接的四次挥手来断开连接：
  1. FIN：浏览器发送FIN（终止）包，表示不再发送数据。
  2. ACK：服务器接收到FIN包后，返回ACK包确认。
  3. FIN：服务器也发送一个FIN包，表示不再发送数据。
  4. ACK：浏览器接收到FIN包后，返回ACK包确认，连接断开。


[网络相关介绍](https://opentp.cn/blog/compute/net.html)